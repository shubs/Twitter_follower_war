<!doctype html>
<html>
  <head>
    <title>Twitter War</title>
    <style>
      body {
        padding-top: 50px;
      }
      .main_page {
        padding: 40px 15px;
        text-align: center;
      }
      .avatarImage {
        border-radius: 7px;
        height: 72px;
        width: 72px;
        border: 2px solid #fff;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
        color: #fff;
      }
    </style>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">


    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="https://cdn.firebase.com/js/client/1.1.1/firebase.js"></script>

  	<script>
      function update(newPost, who){
        $("#"+who+"_img").attr("src",newPost.img);
        $("#"+who+"_fcount").html(newPost.count);
        $("#"+who+"_state").html("+ "+newPost.progress);
        $("#"+who+"_id").html("@"+newPost.screen_name);
        $("#"+who+"_statuses_count").html(newPost.statuses_count);
        console.log(newPost);
      }

      function check_winner(){
        if ($("#competitor_state").val() < $("#you_state").val()) {
          $("#btn_you_state").addClass('btn-success');
          $("#btn_competitor_state").addClass('btn-danger');
        }
        else{
          $("#btn_you_state").addClass('btn-danger');
          $("#btn_competitor_state").addClass('btn-success');
        };
      }

      $(document).ready(function() {
        var postsRef = new Firebase("https://twitterwar.firebaseio.com/you");
        postsRef.on('child_added', function (snapshot) {
          var newPost = snapshot.val();
          update(newPost, "you");
        });

        var postsRef2 = new Firebase("https://twitterwar.firebaseio.com/competitor");
        postsRef2.on('child_added', function (snapshot) {
          var newPost = snapshot.val();
          update(newPost, "competitor");
        });
        check_winner();

      });
  	</script>
  </head>
<body>

    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Project name</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#contact">Contact</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>

    <div class="container">

      <div class="main_page">
        <h1>Twitter War</h1>
        <hr>
        
        <div class="row">
          <div class="col-md-6">
            <h2 class="lead" id="you_id">__</h2>
            <img class="avatarImage" id="you_img" src="https://pbs.twimg.com/profile_images/2284174758/v65oai7fxn47qv9nectx_reasonably_small.png">
            <button id="btn_you_statuses_count" type="button" class="btn">Nb tweets : <span id="you_statuses_count">__</span></button>
            <button id="btn_you_count" type="button" class="btn">Followers : <span id="you_fcount">__</span></button>
            <button id="btn_you_state" type="button" class="btn">State : <span id="you_state">__</span></button>
          </div>
          <div class="col-md-6">
            <h2 class="lead" id="competitor_id">__</h2>
            <img class="avatarImage" id="competitor_img" src="https://pbs.twimg.com/profile_images/2284174758/v65oai7fxn47qv9nectx_reasonably_small.png">
            <button id="btn_competitor_statuses_count" type="button" class="btn">Nb tweets : <span id="competitor_statuses_count">__</span></button>
            <button id="btn_competitor_count" type="button" class="btn">Followers : <span id="competitor_fcount">__</span></button>
            <button id="btn_competitor_state" type="button" class="btn">State : <span id="competitor_state">__</span></button>
          </div>
        </div>
      </div>

    </div><!-- /.container -->
</body>
</html>